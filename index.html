<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vegas Slot - SimulaÃ§Ã£o</title>

<style>
body{
    margin:0;
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Apple Color Emoji","Segoe UI Emoji",Arial,sans-serif;
    background: radial-gradient(circle at center, #1a0000, #000);
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    color:white;
}

.machine{
    background:linear-gradient(180deg,#b8860b,#5a0000);
    border:8px solid gold;
    border-radius:30px;
    padding:30px;
    width:350px;
    box-shadow:0 0 40px gold;
    text-align:center;
}

.title{
    font-size:24px;
    margin-bottom:15px;
}

.credits{
    background:black;
    padding:8px;
    margin-bottom:15px;
    border-radius:8px;
}

.reels{
    display:flex;
    justify-content:center;
    gap:10px;
    margin:20px 0;
}

.reel{
    width:80px;
    height:100px;
    overflow:hidden;
    border:3px solid #222;
    border-radius:10px;
    background:#111;
    position:relative;
}

.symbol-strip{
    position:absolute;
    width:100%;
    text-align:center;
    font-size:55px;
}

button{
    padding:12px 25px;
    font-size:16px;
    font-weight:bold;
    border:none;
    border-radius:20px;
    background:gold;
    cursor:pointer;
}

button:disabled{
    background:#555;
    cursor:not-allowed;
}

.result{
    margin-top:15px;
    min-height:20px;
}
</style>
</head>

<body>

<div class="machine">
    <div class="title">ðŸŽ° VEGAS SLOT</div>
    <div class="credits">Fichas: <span id="credit">10</span></div>

    <div class="reels">
        <div class="reel"><div class="symbol-strip" id="r1"></div></div>
        <div class="reel"><div class="symbol-strip" id="r2"></div></div>
        <div class="reel"><div class="symbol-strip" id="r3"></div></div>
    </div>

    <button onclick="spin()" id="spinBtn">Girar (1 ficha)</button>
    <div class="result" id="result"></div>
</div>

<audio id="spinSound" src="https://assets.mixkit.co/sfx/preview/mixkit-slot-machine-spin-1930.mp3"></audio>
<audio id="winSound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3"></audio>

<script>
let credit = 10;

const prizes = [
    {symbol:"ðŸ””", chance:80, reward:0.05},
    {symbol:"ðŸ’", chance:13, reward:0.10},
    {symbol:"ðŸ‹", chance:5, reward:0.20},
    {symbol:"ðŸ’Ž", chance:1, reward:0.50},
    {symbol:"7ï¸âƒ£", chance:0.001, reward:1.00}
];

function weightedRandom(){
    let total = prizes.reduce((sum,p)=>sum+p.chance,0);
    let random = Math.random()*total;
    let sum = 0;
    for(let p of prizes){
        sum += p.chance;
        if(random <= sum) return p;
    }
}

function createStrip(){
    let strip="";
    for(let i=0;i<20;i++){
        strip += prizes[Math.floor(Math.random()*prizes.length)].symbol+"<br>";
    }
    return strip;
}

function animateReel(reelId, duration){
    return new Promise(resolve=>{
        const reel = document.getElementById(reelId);
        reel.innerHTML = createStrip();
        reel.style.transition="none";
        reel.style.transform="translateY(0px)";

        setTimeout(()=>{
            reel.style.transition=`transform ${duration}ms cubic-bezier(.17,.67,.83,.67)`;
            reel.style.transform="translateY(-900px)";
        },50);

        setTimeout(()=>{
            const result = weightedRandom();
            reel.innerHTML=result.symbol;
            reel.style.transition="none";
            reel.style.transform="translateY(0px)";
            resolve(result);
        },duration+100);
    });
}

async function spin(){
    if(credit<=0) return alert("Sem fichas!");

    credit--;
    document.getElementById("credit").innerText=credit;
    document.getElementById("spinBtn").disabled=true;
    document.getElementById("result").innerText="Girando...";

    document.getElementById("spinSound").play();

    const r1=animateReel("r1",1500);
    const r2=animateReel("r2",2000);
    const r3=animateReel("r3",2500);

    const results=await Promise.all([r1,r2,r3]);

    if(results[0].symbol===results[1].symbol && results[1].symbol===results[2].symbol){
        let reward = results[0].reward;
        credit += Math.floor(reward*10);
        document.getElementById("credit").innerText=credit;
        document.getElementById("result").innerText="ðŸŽ‰ VocÃª ganhou "+reward+" fichas fictÃ­cias!";
        document.getElementById("winSound").play();
    }else{
        document.getElementById("result").innerText="Tente novamente!";
    }

    document.getElementById("spinBtn").disabled=false;
}
</script>

</body>
</html>
